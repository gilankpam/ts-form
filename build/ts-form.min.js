var TSForm;!function(a){var b=function(){function a(){this._tagName="div",this._attributes={},this.cid=_.uniqueId("view")}return a.prototype.tagName=function(a){return this._tagName=a,this},a.prototype.getTagName=function(){return this._tagName},a.prototype.className=function(a){return this._className=a,this},a.prototype.getClassName=function(){return this._className},a.prototype.$=function(a){return this.$el.find(a)},a.prototype.initialize=function(){this._ensureElement()},a.prototype.render=function(){return this},a.prototype.remove=function(){return this._removeElement(),this},a.prototype._removeElement=function(){this.$el.remove()},a.prototype.setElement=function(a){return this.undelegateEvents(),this._setElement(a),this.delegateEvents(),this},a.prototype._setElement=function(a){this.$el=$(a),this.el=this.$el[0]},a.prototype.delegateEvents=function(b){if(b||(b=_.result(this,"viewEvents")),!b)return this;this.undelegateEvents();for(var c in b){var d=b[c];if(_.isFunction(d)||(d=this[d]),d){var e=c.match(a.DELEGATE_EVENT_SPLITTER);this.delegate(e[1],e[2],_.bind(d,this))}}return this},a.prototype.delegate=function(a,b,c){return this.$el.on(a+".delegateEvents"+this.cid,b,c),this},a.prototype.undelegateEvents=function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},a.prototype.undelegate=function(a,b,c){return this.$el.off(a+".delegateEvents"+this.cid,b,c),this},a.prototype._createElement=function(a){return document.createElement(a)},a.prototype._ensureElement=function(){if(this.el)this.setElement(_.result(this,"el"));else{var a=_.extend({},_.result(this,"_attributes"));this._id&&(a.id=_.result(this,"_id")),this._className&&(a["class"]=_.result(this,"_className")),this.setElement(this._createElement(_.result(this,"_tagName"))),this._setAttributes(a)}},a.prototype._setAttributes=function(a){this.$el.attr(a)},a.DELEGATE_EVENT_SPLITTER=/^(\S+)\s*(.*)$/,a}();a.View=b}(TSForm||(TSForm={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},TSForm;!function(a){var b=function(a){function b(){a.call(this),this._tagName="form",this._namespace="vm",this._elements=new TSCore.Data.Dictionary,this.initialize()}return __extends(b,a),Object.defineProperty(b.prototype,"elements",{get:function(){return this._cachedElements||(this._cachedElements=this._elements.toObject()),this._cachedElements},enumerable:!0,configurable:!0}),b.prototype.formatter=function(a){return this._formatter=a,this},b.prototype.getFormatter=function(){return this._formatter},b.prototype.namespace=function(a){return this._namespace=a,this},b.prototype.getNameSpace=function(){return this._namespace},b.prototype.entity=function(a){return this._entity=a,this},b.prototype.getEntity=function(){return this._entity},b.prototype.name=function(a){return this._name=a,this},b.prototype.getName=function(){return this._name},b.prototype.element=function(a){return a.setForm(this),a.formatter(this.getFormatter()),this._elements.set(a.getId(),a),this},b.prototype.getElement=function(a){return this._elements.get(a)},b.prototype.render=function(){var a=this,b=this.getNameSpace(),c=this.getName(),d="Instance";return this.$el.empty(),this.$el.attr("class",this.getClassName()),this.$el.attr("name",b+"."+c+d),this._elements.each(function(b,c){c.getEntity()||c.entity(a.getEntity()),a.$el.append(c.render().$el)}),this},b}(a.View);a.Form=b}(TSForm||(TSForm={}));var TSForm;!function(a){var b=function(a){function b(){a.call(this),this._tagName="div",this._uniqueId=_.uniqueId("element")}return __extends(b,a),b.prototype.id=function(a){return this._id=a,this},b.prototype.getId=function(){return this._id||this._uniqueId},b.prototype.setForm=function(a){return this._form=a,this},b.prototype.getForm=function(){return this._form},b.prototype.formatter=function(a){return this._formatter=a,this},b.prototype.getFormatter=function(){return this._formatter},b.prototype.entity=function(a){return this._entity=a,this},b.prototype.getEntity=function(){return this._entity},b.prototype.type=function(a){return this._type=a,this},b.prototype.name=function(a){return this._name=a,this},b.prototype.getName=function(){return this._name},b.prototype.label=function(a){return this._label=a,this},b.prototype.getLabel=function(){return this.format(this._label)},b.prototype.required=function(a){return void 0===a&&(a=!0),this._required=a,this},b.prototype.format=function(a){var b=this.getFormatter();return b&&(a=b(a)),a},b.prototype.render=function(){var a=this.getForm(),b=a.getNameSpace(),c=a.getName(),d=this.getEntity(),e=this.getName(),f=this.getId();return this.$el.attr("element-options",b+"."+c+".elements."+f),this.$el.attr("model",b+"."+d),this.$el.attr("model-value",b+"."+d+"."+e),this},b}(a.View);a.Element=b}(TSForm||(TSForm={}));var TSForm;!function(a){var b=function(){function a(){console.log("element",this.element)}return a}();a.ElementController=b}(TSForm||(TSForm={}));var TSForm;!function(a){var b=function(){function a(){this.restrict="E",this.replace=!0,this.bindToController=!0,this.controller="TSFormElementController",this.controllerAs="vm",this.scope={model:"=",modelValue:"=",element:"=elementOptions"},this.link=function(a){console.log("scope",a)}}return a.prototype.setTemplateUrl=function(a){return this.templateUrl=a,this},a.prototype.getTemplateUrl=function(){return this.templateUrl},a.prototype.setController=function(a){return this.controller=a,this},a.prototype.getController=function(){return this.controller},a}();a.ElementDirective=b}(TSForm||(TSForm={}));var TSForm;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this._tagName="checkbox-element",this._trueValue=!0,this._falseValue=!1,this.initialize()}return __extends(b,a),b.prototype.trueValue=function(a){return this._trueValue=a,this},b.prototype.falseValue=function(a){return this._falseValue=a,this},b.prototype.getTrueValue=function(){return _.isBoolean(this._trueValue)||_.isNumber(this._trueValue)?this._trueValue:"'"+this._trueValue+"'"},b.prototype.getFalseValue=function(){return _.isBoolean(this._falseValue)||_.isNumber(this._trueValue)?this._falseValue:"'"+this._falseValue+"'"},b}(a.Element);b.CheckboxElement=c}(b=a.Elements||(a.Elements={}))}(TSForm||(TSForm={}));var TSForm;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this._tagName="input-element",this.initialize()}return __extends(b,a),b.prototype.minLength=function(a){return this._minLength=a,this},b.prototype.maxLength=function(a){return this._maxLength=a,this},b}(a.Element);b.InputElement=c}(b=a.Elements||(a.Elements={}))}(TSForm||(TSForm={}));var TSForm;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),this._tagName="password-element",this.initialize()}return __extends(b,a),b}(a.InputElement);a.PasswordElement=b}(b=a.Elements||(a.Elements={}))}(TSForm||(TSForm={}));var TSForm;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this._tagName="select-element",this._options=new TSCore.Data.List,this.initialize()}return __extends(b,a),b.prototype.options=function(a){return this._options.addMany(a),this},b.prototype.option=function(a,b){return this._options.add({value:a,label:b}),this},b.prototype.getOptions=function(){var a=this;return this._options.each(function(b){b.label=a.format(b.label)}),this._options.toArray()},b}(a.Element);b.SelectElement=c}(b=a.Elements||(a.Elements={}))}(TSForm||(TSForm={}));var TSForm;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this._tagName="textarea-element",this.initialize()}return __extends(b,a),b.prototype.minLength=function(a){return this._minLength=a,this},b.prototype.maxLength=function(a){return this._maxLength=a,this},b}(a.Element);b.TextareaElement=c}(b=a.Elements||(a.Elements={}))}(TSForm||(TSForm={}));var TSForm;!function(a){var b=function(){function a(a,b){var c=this;this.$compile=a,this.$timeout=b,this.restrict="E",this.link=function(a,b,d){a.$watch(d.formOptions,function(d){d&&c.$timeout(function(){var e=d,f=e.render().$el;console.log("template",f.clone());var g=c.$compile(f),h=g(a);b.empty(),b.append(h)})})}}return a}();a.FormDirective=b}(TSForm||(TSForm={})),angular.module("ts-form-templates",[]);var module=angular.module("ts-form",["ts-form-templates"]);module.controller("TSFormElementController",TSForm.ElementController),module.directive("tsForm",["$compile","$timeout",function(a,b){return new TSForm.FormDirective(a,b)}]),module.directive("inputElement",function(){return(new TSForm.ElementDirective).setTemplateUrl("templates/input-element.tpl.html")}),module.directive("selectElement",function(){return(new TSForm.ElementDirective).setTemplateUrl("templates/select-element.tpl.html")}),module.directive("checkboxElement",function(){return(new TSForm.ElementDirective).setTemplateUrl("templates/checkbox-element.tpl.html")}),module.directive("textareaElement",function(){return(new TSForm.ElementDirective).setTemplateUrl("templates/textarea-element.tpl.html")}),module.directive("passwordElement",function(){return(new TSForm.ElementDirective).setTemplateUrl("templates/password-element.tpl.html")});